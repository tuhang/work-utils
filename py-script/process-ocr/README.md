# OCR Excel处理工具

## 项目简介

这个工具用于处理含有图片引用的Excel文件，将引用的OCR图片从服务器下载并嵌入到Excel中，方便用户进行图片内容核对工作。

## 功能特点

- 自动识别并处理文件夹中所有尾部包含"-个人"的Excel文件
- 通过API从服务器获取图片链接并下载图片
- 在Excel中添加"用户作答"、"复核状态"和"复核备注"列
- 将下载的图片嵌入到Excel中，方便直接查看
- 支持图片缓存，避免重复下载
- 多线程处理，提高下载和处理效率

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

1. 将需要处理的Excel文件（文件名需以"-个人"结尾）放在与脚本同一目录下
2. 运行脚本：

```bash
python process_ocr_excel.py
```

3. 脚本将自动处理所有符合条件的Excel文件
4. 处理完成后，将在同目录生成"[原文件名]_核对.xlsx"的结果文件

## 输出文件

- **[原文件名]_with_images.xlsx**: 包含图片路径的中间文件
- **[原文件名]_核对.xlsx**: 最终包含嵌入图片的Excel文件，用于核对工作

## 使用说明

在生成的Excel文件中：
- "用户作答"列会显示下载的图片
- "复核状态"列默认值为"SKIP"
- "复核备注"列用于填写核对意见

## 注意事项

- 需要确保有足够的磁盘空间用于存储下载的图片
- 下载的图片会保存在"images"文件夹中
- 如果Excel文件中没有"dz_pic_url_id"列，脚本将跳过该文件
- 处理大量图片时可能需要较长时间，请耐心等待 